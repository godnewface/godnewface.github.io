<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>BibTeX Generator dengan Toggle Slider Tema</title>
    <style>
      :root {
        --bg-color: #fff;
        --text-color: #222;
        --input-bg: #fff;
        --input-border: #ccc;
        --button-bg: #007bff;
        --button-hover: #0056b3;
      }
      [data-theme="dark"] {
        --bg-color: #1e1e1e;
        --text-color: #e0e0e0;
        --input-bg: #2e2e2e;
        --input-border: #444;
        --button-bg: #3a3a3a;
        --button-hover: #505050;
      }
      body {
        background: var(--bg-color);
        color: var(--text-color);
        font-family: sans-serif;
        margin: 0;
        padding: 20px;
      }
      .container {
        max-width: 700px;
        margin: auto;
      }
      h1 {
        text-align: center;
        margin-bottom: 20px;
      }

      .theme-switch {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
      }
      .theme-switch input {
        opacity: 0;
        position: absolute;
      }
      .slider {
        width: 50px;
        height: 26px;
        background: #ccc;
        position: relative;
        border-radius: 34px;
        cursor: pointer;
        transition: background 0.4s;
      }
      .slider::before {
        content: "";
        position: absolute;
        width: 22px;
        height: 22px;
        background: #fff;
        border-radius: 50%;
        top: 2px;
        left: 2px;
        transition: transform 0.4s;
      }
      input:checked + .slider {
        background-color: #66bb6a;
      }
      input:checked + .slider::before {
        transform: translateX(24px);
      }
      .theme-label {
        margin-left: 10px;
        font-size: 14px;
      }

      .row {
        display: flex;
        flex-wrap: wrap;
        margin-bottom: 12px;
      }
      .row label {
        flex: 1 1 120px;
        padding: 5px;
      }
      .row input,
      .row textarea,
      .row select {
        flex: 2 1 200px;
        padding: 8px;
        background: var(--input-bg);
        color: var(--text-color);
        border: 1px solid var(--input-border);
        border-radius: 4px;
      }
      textarea {
        min-height: 80px;
      }
      button {
        padding: 10px 15px;
        margin: 10px 5px 0 0;
        border: none;
        border-radius: 4px;
        background: var(--button-bg);
        color: var(--text-color);
        cursor: pointer;
      }
      button:hover {
        background: var(--button-hover);
      }
      pre {
        background: var(--input-bg);
        padding: 15px;
        white-space: pre-wrap;
        overflow-x: auto;
        border-radius: 4px;
        color: var(--text-color);
      }
      @media (max-width: 480px) {
        .row {
          flex-direction: column;
        }
        .row label,
        .row input,
        .row select,
        .row textarea {
          flex: 1 1 auto;
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div class="theme-switch">
      <input type="checkbox" id="theme-toggle" />
      <label class="slider" for="theme-toggle"></label>
      <span class="theme-label" id="theme-label">Light Mode</span>
    </div>
    <div class="container">
      <h1>BibTeX Generator</h1>
      <div
                  style="
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    margin-bottom: 20px;
                  "
                >
                  <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
                    <a class="a2a_dd" href="https://www.addtoany.com/share"></a
                    ><a class="a2a_button_facebook"></a
                    ><a class="a2a_button_whatsapp"></a
                    ><a class="a2a_button_google_gmail"></a
                    ><a class="a2a_button_x"></a>
                  </div>
                  <script
                    defer
                    src="https://static.addtoany.com/menu/page.js"
                  ></script>
                </div>
  <script defer src="https://static.addtoany.com/menu/page.js"></script>
  <!-- AddToAny END -->
      <form id="bibform">
        <div class="row">
          <label>Type:</label>
          <select id="type">
            <option value="book">Book</option>
            <option value="article">Journal Article</option>
            <option value="inproceedings">Conference Paper</option>
            <option value="techreport">Report</option>
            <option value="thesis">Thesis</option>
            <option value="misc">Web Page</option>
          </select>
        </div>
        <div class="row">
          <label>Title:</label><input id="title" type="text" />
        </div>
        <div class="row">
          <label>Author(s):</label><input id="author" type="text" />
        </div>
        <div class="row">
          <label>Year:</label><input id="year" type="number" />
        </div>
        <div class="row">
          <label>Pages:</label><input id="pages" type="text" />
        </div>
        <div class="row">
          <label>Abstract:</label><textarea id="abstract"></textarea>
        </div>
        <div class="row">
          <label>Tags:</label><input id="tags" type="text" />
        </div>
        <div class="row">
          <label>Author Keywords:</label><input id="keywords" type="text" />
        </div>
        <div class="row">
          <label>City:</label><input id="city" type="text" />
        </div>
        <div class="row">
          <label>Edition:</label><input id="edition" type="text" />
        </div>
        <div class="row">
          <label>Editors:</label><input id="editors" type="text" />
        </div>
        <div class="row">
          <label>Publisher:</label><input id="publisher" type="text" />
        </div>
        <div class="row"><label>URL:</label><input id="url" type="url" /></div>
        <div class="row"><label>DOI:</label><input id="doi" type="text" /></div>
        <div class="row">
          <label>ISBN:</label><input id="isbn" type="text" />
        </div>

        <button type="button" onclick="generateBib()">Generate BibTeX</button>
        <button type="button" onclick="downloadBib()">Download .bib</button>
      </form>
      <pre id="output"></pre>
    </div>

    <script>
      const checkbox = document.getElementById("theme-toggle");
      const label = document.getElementById("theme-label");

      function applyTheme(isDark) {
        document.documentElement.setAttribute(
          "data-theme",
          isDark ? "dark" : "light"
        );
        label.textContent = isDark ? "Dark Mode" : "Light Mode";
        localStorage.setItem("theme", isDark ? "dark" : "light");
      }

      const saved = localStorage.getItem("theme");
      if (saved) {
        const isDark = saved === "dark";
        checkbox.checked = isDark;
        applyTheme(isDark);
      } else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        checkbox.checked = true;
        applyTheme(true);
      }

      checkbox.addEventListener("change", (e) => applyTheme(e.target.checked));

      function generateBib() {
        const get = (id) => document.getElementById(id).value.trim();
        const citekey =
          (get("author").split(/,| /)[0] || "unknown") + get("year");
        const type = get("type");
        const fields = {
          title: get("title"),
          author: get("author"),
          year: get("year"),
          pages: get("pages"),
          address: get("city"),
          edition: get("edition"),
          editor: get("editors"),
          publisher: get("publisher"),
          url: get("url"),
          doi: get("doi"),
          isbn: get("isbn"),
          keywords: get("keywords"),
          tags: get("tags"),
          abstract: get("abstract"),
        };
        let entry = `@${type}{${citekey},\n`;
        for (const [f, v] of Object.entries(fields))
          if (v) entry += `  ${f} = {${v}},\n`;
        entry = entry.replace(/,\n$/, "\n") + "}";
        document.getElementById("output").innerText = entry;
      }

      function downloadBib() {
        const text = document.getElementById("output").innerText;
        if (!text) return alert("Generate dulu bibliografinya!");
        const blob = new Blob([text], { type: "text/plain" });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "reference.bib";
        a.click();
        URL.revokeObjectURL(a.href);
      }
    </script>
  </body>
</html>
